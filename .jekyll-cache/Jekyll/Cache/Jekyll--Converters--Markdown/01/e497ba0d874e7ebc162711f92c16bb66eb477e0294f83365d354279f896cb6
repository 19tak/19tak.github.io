I"Š<h1 id="ë¬¸ì œ">ë¬¸ì œ</h1>

<p>ê·¸ë™ì•ˆ ì½ì–´ì˜¤ë˜ csv íŒŒì¼ê³¼ëŠ” ë‹¤ë¥´ê²Œ í•´ë‹¹ data setì€ ë§ì€ ìˆ˜ì˜ featureì™€ ë°ì´í„°ë“¤ë¡œ ì´ë£¨ì–´ì ¸ì„œ íŒŒì¼ì´ ë‚˜ë‰˜ì–´ì ¸ìˆë‹¤.</p>

<p>â€‹features.txt ì—ëŠ” ì¤‘ë³µì„ í¬í•¨í•œ 561ê°œì˜ featureì— ëŒ€í•œ indexì™€ nameì´
_text.tx, _train.txt ì—ëŠ” ê° featureì— ëŒ€í•œ dataë“¤ì˜ test, train splitì´ ë‹´ê²¨ì ¸ìˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import pandas as pd
import matplotlib.pyplot as plt
%matplotlib inline

# features.txt íŒŒì¼ì—ëŠ” í”¼ì²˜ ì´ë¦„ indexì™€ í”¼ì²˜ëª…ì´ ê³µë°±ìœ¼ë¡œ ë¶„ë¦¬ë˜ì–´ ìˆìŒ. ì´ë¥¼ DataFrameìœ¼ë¡œ ë¡œë“œ.
feature_name_df = pd.read_csv('./human_activity/features.txt',sep='\s+',
                        header=None,names=['column_index','column_name'])

# í”¼ì²˜ëª… indexë¥¼ ì œê±°í•˜ê³ , í”¼ì²˜ëª…ë§Œ ë¦¬ìŠ¤íŠ¸ ê°ì²´ë¡œ ìƒì„±í•œ ë’¤ ìƒ˜í”Œë¡œ 10ê°œë§Œ ì¶”ì¶œ
feature_name = feature_name_df.iloc[:, 1].values.tolist()
print('ì „ì²´ í”¼ì²˜ëª…ì—ì„œ 10ê°œë§Œ ì¶”ì¶œ:', feature_name[:10])
</code></pre></div></div>
<p><img src="https://user-images.githubusercontent.com/84369912/126767492-c04d488e-e2a8-4844-bf71-23afefa70a85.png" alt="image" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>feature_dup_df = feature_name_df.groupby('column_name').count()
feature_name_df.groupby('column_name').count()
print(feature_dup_df[feature_dup_df['column_index']&gt;1].count())
feature_dup_df[feature_dup_df['column_index']&gt;1].head()
</code></pre></div></div>
<p><img src="https://user-images.githubusercontent.com/84369912/126767570-c87988f7-999b-4dad-9da7-ebe30a0aea20.png" alt="image" />
<img src="https://user-images.githubusercontent.com/84369912/126767591-4396e768-3f70-462f-abc1-cd6cdba34a5d.png" alt="image" /></p>

<p>ì¤‘ë³µëœ feature nameì„ í”¼í•˜ëŠ” ê²ƒì„ ì›ì¹™ìœ¼ë¡œ í•˜ê¸° ë•Œë¬¸ì— ì¤‘ë³µëœ feature nameë“¤ì„ í™•ì¸í•´ì£¼ì—ˆë‹¤.</p>

<p>ì¤‘ë³µëœ ì›ë³¸ feature name ë’¤ì— _1 ë˜ëŠ” _2ë¥¼ ì¶”ê°€í•˜ì—¬ ì¤‘ë³µì„ í”¼í•´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ ì‘ì„±.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def get_new_feature_name_df(old_feature_name_df):
    feature_dup_df = pd.DataFrame(data=old_feature_name_df.groupby('column_name').cumcount(),
                                 columns=['dup_cnt'])
    feature_dup_df = feature_dup_df.reset_index()
    new_feature_dup_df = pd.merge(old_feature_name_df.reset_index(), feature_dup_df, how='outer')
    new_feature_dup_df['column_name'] = new_feature_dup_df[['column_name',
                                                            'dup_cnt']].apply(lambda x: x[0]+'_'+
                                                                             str(x[1])
                                                                             if x[1]&gt;0
                                                                             else x[0], axis=1)
    new_feature_dup_df = new_feature_dup_df.drop(['index'],axis=1)
    return new_feature_dup_df
</code></pre></div></div>
<p>ì¤‘ë³µëœ feature nameì„ ì²˜ë¦¬í•´ì£¼ê³  test, train split ëœ ë°ì´í„°ë¥¼ ë¡œë“œí•œë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def get_human_dataset():
    
    # ê° ë°ì´í„° íŒŒì¼ì€ ê³µë°±ìœ¼ë¡œ ë¶„ë¦¬, read_csvì—ì„œ ê³µë°± ë¬¸ìë¥¼ sepìœ¼ë¡œ í• ë‹¹
    feature_name_df = pd.read_csv('./human_activity/features.txt',sep='\s+',
                             header=None, names=['column_index','column_name'])
    
    # ì¤‘ë³µëœ í”¼ì³ëª…ì„ ìˆ˜ì •í•˜ëŠ” get_new_feature_name_df()ë¥¼ ì´ìš©, ì‹ ê·œ í”¼ì²˜ëª… DataFrame ìƒì„±
    new_feature_name_df = get_new_feature_name_df(feature_name_df)
    
    # DataFrameì— í”¼ì²˜ëª…ì„ ì¹¼ëŸ¼ìœ¼ë¡œ ë¶€ì—¬í•˜ê¸° ìœ„í•´ ë¦¬ìŠ¤íŠ¸ ê°ì²´ë¡œ ë‹¤ì‹œ ë³€í™˜
    feature_name = new_feature_name_df.iloc[:,1].values.tolist()
    
    # í•™ìŠµ í”¼ì²˜ ë°ì´í„°ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ í”¼ì²˜ ë°ì´í„°ë¥¼ DataFrameìœ¼ë¡œ ë¡œë”©. ì¹¼ëŸ¼ëª…ì€ feature_name ì ìš©
    X_train = pd.read_csv('./human_activity/train/X_train.txt',sep='\s+',names=feature_name)
    X_test = pd.read_csv('./human_activity/test/X_test.txt',sep='\s+',names=feature_name)
    
    # í•™ìŠµ ë ˆì´ë¸”ê³¼ í…ŒìŠ¤íŠ¸ ë ˆì´ë¸” ë°ì´í„°ë¥¼ DataFrameìœ¼ë¡œ ë¡œë”©í•˜ê³  ì¹¼ëŸ¼ëª…ì€ actionìœ¼ë¡œ ë¶€ì—¬
    y_train = pd.read_csv('./human_activity/train/y_train.txt',sep='\s+',header=None,names=['action'])
    y_test = pd.read_csv('./human_activity/test/y_test.txt',sep='\s+',header=None,names=['action'])
    
    # ë¡œë“œëœ í•™ìŠµ/í…ŒìŠ¤íŠ¸ìš© DataFrameì„ ëª¨ë‘ ë°˜í™˜
    return X_train, X_test, y_train, y_test

X_train, X_test, y_train, y_test = get_human_dataset()
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>print('## í•™ìŠµ í”¼ì²˜ ë°ì´í„°ì…‹ info()')
print(X_train.info())
</code></pre></div></div>
:ET