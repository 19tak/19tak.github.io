I"
<h4 id="dplyr">dplyr</h4>

<h1 id="문제">문제</h1>
<h2 id="분석-도전">분석 도전</h2>
<p>미국 동북중부 437개 지역의 인구통계 정보를 담고 있는 midwest 데이터를 사용해 데이터 분석 문제를 해결해 보세요. midwest는 ggplot2 패키지에 들어 있습니다.</p>
<ul>
  <li>문제1. popadults는 해당 지역의 성인 인구, poptotal은 전체 인구를 나타냅니다. midwest 데이터에 ‘전체 인구 대비 미성년 인구 백분율’ 변수를 추가하세요.</li>
  <li>문제2. 미성년 인구 백분율이 가장 높은 상위 5개 county(지역)의 미성년 인구 백분율을 출력하세요.</li>
  <li>문제3. 분류표의 기준에 따라 미성년 비율 등급 변수를 추가하고, 각 등급에 몇 개의 지역이 있는지 알아보세요.</li>
</ul>

<table>
  <thead>
    <tr>
      <th>분류</th>
      <th>기준</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>large</td>
      <td>40% 이상</td>
    </tr>
    <tr>
      <td>middle</td>
      <td>30% ~ 40% 미만</td>
    </tr>
    <tr>
      <td>small</td>
      <td>30% ~ 40% 미만</td>
    </tr>
  </tbody>
</table>

<h2 id="dplyr-1">dplyr</h2>
<blockquote>

  <p><br /></p>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># setting
rm(list=ls())
getwd()
setwd("D:\\tak\\r\\hw\\dplyr")

# import library
library(dplyr)
library(ggplot2)

# read data
midwest &lt;- as.data.frame(ggplot2::midwest)

# Q1. 전체 인구 대비 미성년 인구 백분율 변수 추가
# df에 value(백분율) 추가
midwest &lt;- 
  midwest %&gt;% 
  mutate(value=(poptotal-popadults)/poptotal*100)

# Q2. value 상위 5개 county의 value 출력
midwest %&gt;% 
  arrange(desc(value)) %&gt;% 
  select(county,value) %&gt;% 
  head

# Q3. 미성년 비율 등급 변수 추가, 각 등급에 몇개의 지역이 있는지 출력
# value 별 grade 추가
midwest  &lt;-
  midwest %&gt;% 
  mutate(grade=ifelse(value&gt;=40,"large",
                      ifelse(value&gt;=30,"middle","small")))
n &lt;- midwest %&gt;%  group_by(grade) %&gt;% summarise(n=n())
as.data.frame(n)

# Q4. 전체 인구 대비 아시아인 인구 백분율 변수 추가, 하위 10개 지역 state, county 백분율 출력
# df에 asian_value(백분율) 추가 / 하위 10개 지역 해당 항목 출력
midwest %&gt;% 
  mutate(asian_value=popasian/poptotal*100) %&gt;% 
  arrange(asian_value) %&gt;% 
  select(state,county,asian_value) %&gt;% 
  head(10)
</code></pre></div>  </div>

</blockquote>
:ET