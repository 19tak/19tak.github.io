---
layout: post
title: "[07] R, 실전회귀분석 과제 "
categories: [R, KFQ]
tags: [R, KFQ, score, linear regression, assignment]
fullview: false
comments: false
---

#### dplyr



# **문제**
### 분석 도전
미국 동북중부 437개 지역의 인구통계 정보를 담고 있는 midwest 데이터를 사용해 데이터 분석 문제를 해결해 보세요.    
midwest는 ggplot2 패키지에 들어 있습니다.   
+ __문제1.__ popadults는 해당 지역의 성인 인구, poptotal은 전체 인구를 나타냅니다. midwest 데이터에 '전체 인구 대비 미성년 인구 백분율' 변수를 추가하세요.   
+ __문제2.__ 미성년 인구 백분율이 가장 높은 상위 5개 county(지역)의 미성년 인구 백분율을 출력하세요.   
+ __문제3.__ 분류표의 기준에 따라 미성년 비율 등급 변수를 추가하고, 각 등급에 몇 개의 지역이 있는지 알아보세요.   

![image](https://user-images.githubusercontent.com/84369912/126747506-8ae34da4-a3f7-47a5-b14c-b21bce1d81df.png)

+ __문제4.__ popasian은 해당 지역의 아시아인 인구를 나타냅니다. '전체 인구 대비 아시아인 인구 백분율' 변수를 추가하고,   
하위 10개 지역의 state(주), county(지역명), 아시아인 인구 백분율을 출력하세요.   


### 결과 코드
```
Call:
lm(formula = 성적 ~ IQ)
Residuals:
Min 1Q Median 3Q Max
-3.6598 -2.2384 -0.2674 1.6186 6.3544
Coefficients:
Estimate Std. Error t value Pr(>|t|)
(Intercept) -5.2918 13.5832 -0.390 0.707007
IQ 0.6714 0.1080 6.217 0.000255 ***
---
Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residual standard error: 3.322 on 8 degrees of freedom
Multiple R-squared: 0.8285, Adjusted R-squared: 0.8071
F-statistic: 38.65 on 1 and 8 DF, p-value: 0.0002547
```

회귀 분석 결과에 의해 y=0.6714*x-5.2918 의 관계식으로 IQ 125에 대한 성적 예측가능

```
1 2 3 4 5 6 7 8 9 10
88.70224 78.63145 75.27451 85.34531 65.20372 77.28867 83.33115 71.91758 80.64560 82.65976
```

```
Call:
lm(formula = 성적 ~ 다니는학원수)
Coefficients:
(Intercept) 다니는학원수
69.488 4.953
```

```
Call:
lm(formula = 성적 ~ IQ + 다니는학원수 + 게임하는시간 + TV시청시간)
Coefficients:
(Intercept) IQ 다니는학원수 게임하는시간 TV시청시간
23.2992 0.4684 0.7179 -0.8390 -1.3854
```
coefficients와, 다니는학원수 n, 게임하는 시간 g, TV 시청시간 t, IQ x에서
y=0.4684\*x+0.7179\*n-0.8390\*g-1.3854\*t +23.2992

![image](https://user-images.githubusercontent.com/84369912/126749203-f8215a7a-464e-47f0-a299-36346fbd5eba.png)



### 실행 코드
```
# setting
rm(list=ls())
getwd()
setwd("D:\\tak\\r\\doit_book\\ml\\machinelearning")

# read data
score <- read.csv("score.txt",header=T,sep=",")
score
attach(score)

lm1 <- lm(성적~IQ)
lm1
summary(lm1)

# 회귀식
x<-125
y<-0.6714*x-5.2918
coef(lm1)
predict(lm1,newdata=data.frame(c(125,125,125,125,125,125,125,125,125,125)))

lm2 <- lm(성적~다니는학원수)
lm2
summary(lm2)

lm3 <- lm(성적~IQ+다니는학원수+게임하는시간+TV시청시간)
lm3
summary(lm3)

y
plot(IQ,성적,pch=20,col="red")
abline(lm1,col="blue")# setting
rm(list=ls())
getwd()
setwd("D:\\tak\\r\\doit_book\\ml\\machinelearning")

# read data
score <- read.csv("score.txt",header=T,sep=",")
score
attach(score)

lm1 <- lm(성적~IQ)
lm1
summary(lm1)

# 회귀식
x<-125
y<-0.6714*x-5.2918
coef(lm1)
predict(lm1,newdata=data.frame(c(125,125,125,125,125,125,125,125,125,125)))

lm2 <- lm(성적~다니는학원수)
lm2
summary(lm2)

lm3 <- lm(성적~IQ+다니는학원수+게임하는시간+TV시청시간)
lm3
summary(lm3)

y
plot(IQ,성적,pch=20,col="red")
abline(lm1,col="blue")
```