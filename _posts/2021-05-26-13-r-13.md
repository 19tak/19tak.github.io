---
layout: post
title: "[13] R 과제, 실전데이터분석 과제 - 군집분석 "
categories: [R, KFQ]
tags: [R, KFQ, iris, clustering, assignment]
fullview: false
comments: false
---

#### dplyr

![image](https://user-images.githubusercontent.com/84369912/126751266-1c21ebfb-585f-4ae0-b4ec-0604fcb56ecd.png)

![image](https://user-images.githubusercontent.com/84369912/126751279-00783019-cb6b-4cc2-b943-94b6c36742de.png)

![image](https://user-images.githubusercontent.com/84369912/126751292-0841f462-1a9e-4d95-81f9-e08a17f3a424.png)

![image](https://user-images.githubusercontent.com/84369912/126751306-804912fb-126f-42b5-b3e4-6f80f7125b09.png)

![image](https://user-images.githubusercontent.com/84369912/126751334-b126b661-be40-4cee-8062-d927a2acfb98.png)

![image](https://user-images.githubusercontent.com/84369912/126751344-3d459af7-1b8b-41e6-92c8-a3ea9efaf5b9.png)



## 코드
```
# setting
rm(list=ls())
getwd()
setwd("D:\\tak\\r\\doit_book\\ml\\machinelearning")

# library
library(cluster)
library(graphics)

# read data
academy <- read.csv("academy.csv")
head(academy)

#계층형 군집
hcl <- hclust(dist(academy)^2,method="single")
plot(hcl,hang=-1,xlab="student",ylab="distance")
## 약 5~6개의 군집 확인가능

#k-means 군집 5개
kms <- kmeans(academy,5); kms
plot(academy,col=kms$cluster)

# elbow point 구하기
wss <- 0
#k를 1~10 변화시키며 각 withinss 값을 wss에 저장
for(i in 1:10) wss[i] <- sum(kmeans(academy,centers=i)$withinss)
plot(1:10,wss,type="b",xlab="Number of Clusters",ylab="within group sum of squares")
## number of cluster가 6인 지점 부근이 elbow point임을 확인

#k-means 군집 6개
kms <- kmeans(academy,6); kms
plot(academy,col=kms$cluster)
```