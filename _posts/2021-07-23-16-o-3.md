---
layout: post
title: "[03] Oracle, 마당서점 연습문제3 "
categories: [Oracle, KFQ]
tags: [Oracle, KFQ, SQL]
fullview: false
comments: false
---

## 문제
마당서점의 고객이 요구하는 다음 질문에 대해 SQL 문을 작성하시오.
7. 박지성이 구매하지 않은 도서의 이름

​

마당서점의 운영자와 경영자가 요구하는 다음 질문에 대해 SQL 문을 작성하시오.
8. 주문하지 않은 고객의 이름(부속질의 사용)
12. 도서의 가격(Book 테이블)과 판매가격(Orders 테이블)의 차이가 가장 많은 주문
13. 도서의 판매액 평균보다 자신의 구매액 평균이 더 높은 고객의 이름

## 답안
```
-- 과제3
-- 1. (7) 박지성이 구매하지 않은 도서의 이름
select bookname as 도서이름 from book b where not exists
(select b.bookname from orders od, customer cs where od.custid=cs.custid
and b.bookid=od.bookid and cs.name like '박지성');
-- 2. (8) 주문하지 않은 고객의 이름 (부속질의 사용)
select name from customer cs where not exists
(select cs.name from orders od where od.custid=cs.custid);
-- 2. (12) 도서의 가격 (book 테이블)과 판매가격 (orders 테이블)의 차이가 가장 많은 주문
select *
from orders od1, book b1 where od1.bookid=b1.bookid and
abs(b1.price - od1.saleprice)=
(select max(abs(b2.price - od2.saleprice)) 
from book b2,orders od2 where od2.bookid=b2.bookid);
-- 2. (13) 도서의 판매액 평균보다 자신의 구매액 평균이 더 높은 고객의 이름
select name from 
(select cs.name, avg(saleprice) avg_p from customer cs, orders od
where cs.custid=od.custid group by cs.name) dt 
where dt.avg_p > (select avg(od.saleprice) from orders od);
```